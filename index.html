<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ãƒ­ã‚°ã‚¤ãƒ³ - ã‚»ã‚­ãƒ¥ãƒ¬ã‚¢ã‚·ãƒ†ã‚£</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="css/custom.css">
  
  <script>
    window.i18nData = {
      ja: {
        'login.title': 'ãƒ­ã‚°ã‚¤ãƒ³',
        'login.site.title': 'SECUREA City ã¤ãã°ç ”ç©¶å­¦åœ’',
        'login.site.subtitle': 'å…¥å±…è€…å°‚ç”¨Webã‚µã‚¤ãƒˆ',
        'login.app.title': 'ä½ã¾ã„ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã‚¢ãƒ—ãƒª',
        'login.username': 'ãƒ¦ãƒ¼ã‚¶ãƒ¼å',
        'login.password': 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰',
        'login.remember': 'ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ã‚’ä¿æŒ',
        'login.button': 'ãƒ­ã‚°ã‚¤ãƒ³',
        'login.demo': 'ãƒ‡ãƒ¢ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ',
        'login.demo.text': 'ãƒ¦ãƒ¼ã‚¶ãƒ¼å: B71 / ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰: demo',
        'login.info.screens': 'ã“ã®ãƒ‡ãƒ¢ã¯å…¨15ç”»é¢ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™',
        'login.info.language': 'ğŸŒ å³ä¸Šã®ãƒœã‚¿ãƒ³ã§è¨€èªã‚’åˆ‡ã‚Šæ›¿ãˆã‚‰ã‚Œã¾ã™',
        'login.error': 'ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¾ãŸã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“'
      },
      en: {
        'login.title': 'Login',
        'login.site.title': 'SECUREA City Tsukuba Kenkyugakuen',
        'login.site.subtitle': 'Resident Portal',
        'login.app.title': 'Community Living App',
        'login.username': 'Username',
        'login.password': 'Password',
        'login.remember': 'Remember me',
        'login.button': 'Login',
        'login.demo': 'Demo Account',
        'login.demo.text': 'Username: B71 / Password: demo',
        'login.info.screens': 'This demo consists of 15 screens',
        'login.info.language': 'ğŸŒ Switch language with buttons above',
        'login.error': 'Invalid username or password'
      },
      zh: {
        'login.title': 'ç™»å½•',
        'login.site.title': 'SECUREA City ç­‘æ³¢ç ”ç©¶å­¦å›­',
        'login.site.subtitle': 'ä½æˆ·ä¸“ç”¨ç½‘ç«™',
        'login.app.title': 'å±…ä½ç¤¾åŒºåº”ç”¨',
        'login.username': 'ç”¨æˆ·å',
        'login.password': 'å¯†ç ',
        'login.remember': 'ä¿æŒç™»å½•çŠ¶æ€',
        'login.button': 'ç™»å½•',
        'login.demo': 'æ¼”ç¤ºè´¦æˆ·',
        'login.demo.text': 'ç”¨æˆ·å: B71 / å¯†ç : demo',
        'login.info.screens': 'æ­¤æ¼”ç¤ºç”±15ä¸ªç•Œé¢ç»„æˆ',
        'login.info.language': 'ğŸŒ ä½¿ç”¨ä¸Šæ–¹æŒ‰é’®åˆ‡æ¢è¯­è¨€',
        'login.error': 'ç”¨æˆ·åæˆ–å¯†ç ä¸æ­£ç¡®'
      }
    };
    
    console.log('âœ… i18nData embedded successfully');
    console.log('Available languages:', Object.keys(window.i18nData));
  </script>
</head>
<body class="bg-gray-50">
  <div class="fixed top-4 right-4 language-switcher z-50 shadow-lg">
    <button class="lang-btn" data-lang="ja">JA</button>
    <button class="lang-btn" data-lang="en">EN</button>
    <button class="lang-btn" data-lang="zh">ZH</button>
  </div>

  <div class="min-h-screen flex items-center justify-center p-4">
    <div class="max-w-md w-full">
      <div class="text-center mb-8 fade-in">
        <h1 class="text-3xl font-bold text-gray-900 mb-2" data-i18n="login.site.title">
          SECUREA City ã¤ãã°ç ”ç©¶å­¦åœ’
        </h1>
        <p class="text-gray-600" data-i18n="login.site.subtitle">å…¥å±…è€…å°‚ç”¨Webã‚µã‚¤ãƒˆ</p>
        <h2 class="text-2xl font-bold text-blue-600 mt-4" data-i18n="login.app.title">
          ä½ã¾ã„ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã‚¢ãƒ—ãƒª
        </h2>
      </div>

      <div class="bg-white rounded-lg shadow-lg p-8 fade-in">
        <h3 class="text-xl font-bold text-gray-900 mb-6 text-center" data-i18n="login.title">
          ãƒ­ã‚°ã‚¤ãƒ³
        </h3>

        <form onsubmit="handleLogin(event)">
          <div class="mb-4">
            <label class="block text-sm font-bold text-gray-700 mb-2" data-i18n="login.username">
              ãƒ¦ãƒ¼ã‚¶ãƒ¼å
            </label>
            <input 
              type="text" 
              id="username"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              value="B71"
              required
            >
          </div>

          <div class="mb-6">
            <label class="block text-sm font-bold text-gray-700 mb-2" data-i18n="login.password">
              ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰
            </label>
            <input 
              type="password" 
              id="password"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              value="demo"
              required
            >
          </div>

          <div class="mb-6">
            <label class="flex items-center cursor-pointer">
              <input type="checkbox" class="w-4 h-4 text-blue-600 rounded">
              <span class="ml-2 text-gray-900" data-i18n="login.remember">ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ã‚’ä¿æŒ</span>
            </label>
          </div>

          <button 
            type="submit"
            class="w-full bg-blue-600 text-white py-3 rounded-lg font-bold hover:bg-blue-700 transition"
          >
            <span data-i18n="login.button">ãƒ­ã‚°ã‚¤ãƒ³</span>
          </button>
        </form>

        <div class="mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4">
          <p class="text-sm text-blue-900">
            <span class="font-bold" data-i18n="login.demo">ãƒ‡ãƒ¢ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ</span><br>
            <span data-i18n="login.demo.text">ãƒ¦ãƒ¼ã‚¶ãƒ¼å: B71 / ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰: demo</span>
          </p>
        </div>
      </div>

      <div class="mt-6 text-center text-sm text-gray-600">
        <p data-i18n="login.info.screens">ã“ã®ãƒ‡ãƒ¢ã¯å…¨15ç”»é¢ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™</p>
        <p class="mt-1" data-i18n="login.info.language">ğŸŒ å³ä¸Šã®ãƒœã‚¿ãƒ³ã§è¨€èªã‚’åˆ‡ã‚Šæ›¿ãˆã‚‰ã‚Œã¾ã™</p>
      </div>
    </div>
  </div>

  <script>
    console.log('=== ç¿»è¨³ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–é–‹å§‹ ===');
    
    class EmbeddedLanguageManager {
      constructor() {
        console.log('EmbeddedLanguageManager constructor');
        this.currentLanguage = localStorage.getItem('language') || 'ja';
        this.translations = window.i18nData;
        console.log('âœ… Translations loaded:', Object.keys(this.translations));
        console.log('âœ… Current language:', this.currentLanguage);
      }
      
      setLanguage(lang) {
        console.log('ğŸ”„ Changing language to:', lang);
        if (this.translations[lang]) {
          this.currentLanguage = lang;
          localStorage.setItem('language', lang);
          this.updatePage();
          this.updateLanguageButtons();
          console.log('âœ… Language changed successfully');
        } else {
          console.error('âŒ Translation not found for:', lang);
        }
      }
      
      translate(key) {
        const translation = this.translations[this.currentLanguage];
        return translation && translation[key] ? translation[key] : key;
      }
      
      updatePage() {
        console.log('ğŸ”„ Updating page translations');
        let count = 0;
        document.querySelectorAll('[data-i18n]').forEach(element => {
          const key = element.getAttribute('data-i18n');
          const translation = this.translate(key);
          
          if (element.children.length === 0) {
            element.textContent = translation;
          } else {
            for (let node of element.childNodes) {
              if (node.nodeType === Node.TEXT_NODE && node.textContent.trim()) {
                node.textContent = translation;
                break;
              }
            }
          }
          count++;
        });
        console.log('âœ… Translated', count, 'elements');
      }
      
      updateLanguageButtons() {
        document.querySelectorAll('.lang-btn').forEach(btn => {
          const lang = btn.getAttribute('data-lang');
          if (lang === this.currentLanguage) {
            btn.classList.add('active');
            btn.classList.remove('inactive');
          } else {
            btn.classList.remove('active');
            btn.classList.add('inactive');
          }
        });
      }
      
      init() {
        console.log('ğŸ”„ Initializing buttons');
        document.querySelectorAll('.lang-btn').forEach(btn => {
          btn.addEventListener('click', () => {
            const lang = btn.getAttribute('data-lang');
            console.log('ğŸ–±ï¸ Button clicked:', lang);
            this.setLanguage(lang);
          });
        });
        this.updatePage();
        this.updateLanguageButtons();
        console.log('âœ… Initialization complete');
      }
    }
    
    // DOMãŒèª­ã¿è¾¼ã¾ã‚ŒãŸã‚‰å®Ÿè¡Œ
    document.addEventListener('DOMContentLoaded', function() {
      console.log('=== DOMContentLoaded ===');
      
      if (!window.i18nData) {
        console.error('âŒ CRITICAL: i18nData not found!');
        alert('ç¿»è¨³ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ');
        return;
      }
      
      window.languageManager = new EmbeddedLanguageManager();
      window.languageManager.init();
      
      window.i18n = function(key) {
        return window.languageManager.translate(key);
      };
      
      console.log('=== ç¿»è¨³ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–å®Œäº† ===');
    });
    
    function handleLogin(event) {
      event.preventDefault();
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      
      if (username === 'B71' && password === 'demo') {
        // ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ã‚’localStorageã«ä¿å­˜
        localStorage.setItem('isLoggedIn', 'true');
        localStorage.setItem('roomNumber', username);
        window.location.href = 'home.html';
      } else {
        const errorMsg = window.i18n ? window.i18n('login.error') : 'ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¾ãŸã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“';
        alert(errorMsg);
      }
    }
  </script>
</body>
</html>